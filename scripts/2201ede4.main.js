"use strict";var Templates={};Templates.templatesCache={},Templates.baseUrl="templates/",Templates.get=function(a,b){var c=this.baseUrl+a;if(!b&&Templates.templatesCache[c]){var d=$.Deferred().resolve(Templates.templatesCache[c]);return d.promise()}return $.get(c).promise().then(function(a){return Templates.templatesCache[c]=a,a})},Templates.build=function(a,b,c){return Templates.get(a,c).then(function(a){var c=Handlebars.compile(a);return b=b?b:{},c(b)})},function(a){var b={};b.totalItems=10,b.init=function(){this.loadData(this.totalItems).then(function(c){var d=b.sortItems(c.items);return a("#feed-title").text(c.title),a("#feed-description").text(c.description),d.forEach(function(c){b.buildItem(c).then(function(b){a("#feed").append(b)})})}).then(function(){return a("#feed article").click(function(){a(this).toggleClass("selected")})}).then(function(){a("#feed").masonry({columnWidth:10,itemSelector:".item"})}).then(function(){setTimeout(function(){a("#floatingBarsG").hide(),a(".hidden").css("display","none").removeClass("hidden").fadeIn("fast"),a("#feed").masonry()},1500)})},b.loadData=function(b){return a.get("http://pipes.yahoo.com/pipes/pipe.run?_id=DqsF_ZG72xGLbes9l7okhQ&_render=json").then(function(a){var c={};return c.title=a.value.title,c.description=a.value.description,c.items=a.value.items.splice(0,b),c})},b.sortItems=function(a){for(var b=a.length-1;b>=0;b--){var c=new Date(a[b].pubDate);a[b].localeDate=c.toLocaleDateString(),a[b].localeTime=c.toLocaleTimeString()}return a.sort(function(a,b){var c=new Date(a.pubDate),d=new Date(b.pubDate);return d>c})},b.buildItem=function(b){if(b.enclosure)b.image=b.enclosure.url;else if(b["media:content"])b.image=b["media:content"].url;else if(b["media:thumbnail"])b.image=b["media:thumbnail"].url;else{var c=a("<div>",{html:b.description}),d=a("img",c);d[0]&&(b.image=a(d[0]).attr("src"))}return b.description=a("<p>",{html:b.description}).text(),b.description.length>80&&(b.shortDescription=b.description.substr(0,77)+"..."),Templates.build("item.html",b)},b.init()}(jQuery);